<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>download excel file</title>
    <link rel="shortcut icon" href="aa.jpg" type="image/x-icon">
    <link rel="stylesheet" href="Cbox.css" />
</head>
<body>
    <div class="box">
        <div class="zeel"><img src="aa.jpg" alt="photo" /></div>
    </div>
    <div class="all-data">

      <h2>Select Date Range to Download Excel</h2>
  <div style="margin-bottom: 10px;">
  <label><strong>From:</strong> <input type="date" id="fromDate"></label>
  <label><strong>To:</strong> <input type="date" id="toDate"></label>
</div>

<!-- ðŸ†• Quick Range Buttons -->
<div style="margin-bottom: 20px;">
  <button onclick="setDateRange('today')">Today</button>
  <button onclick="setDateRange('last7')">Last 7 Days</button>
  <button onclick="setDateRange('lastMonth')">Last Month</button>
  <button onclick="setDateRange('thisYear')">This Year</button>
  <button onclick="setDateRange('all')">All Time</button>
</div>
 
 <div class="dwon">
  <button onclick="downloadExcel()" id="dw">ðŸ“¥ Download Excel ðŸ“¥</button>
</div>



 <div id="sidebar" class="sidebar">
  <button class="closebtn" onclick="toggleSidebar()">&times;</button>
  <a href="index.html">Home</a>
  <a href="Abox.html">Add New Entry</a>
  <a href="Bbox.html">Detail</a>

</div>
<button class="openbtn" onclick="toggleSidebar()">&#9776; Menu</button>


</div>





  <script>
    function downloadExcel() {
      const data = JSON.parse(localStorage.getItem("parcelData")) || [];
      const fromDate = document.getElementById("fromDate").value;
      const toDate = document.getElementById("toDate").value;

      if (!fromDate || !toDate) {
        alert("Please select a date range.");
        return;
      }

      const from = new Date(fromDate);
      const to = new Date(toDate);

      const filteredData = data.filter(entry => {
        const entryDate = new Date(entry.date);
        return entryDate >= from && entryDate <= to;
      });

      if (filteredData.length === 0) {
        alert("No data in this date range.");
        return;
      }

      let csv = "Parcel Number,Weight,Date,Size,Percentage,Color\n";
      filteredData.forEach(entry => {
        csv += `${entry.parcel},${entry.weight},${entry.date},${entry.size},${entry.percentage},${entry.color}\n`;
      });

      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `parcel_data_${fromDate}_to_${toDate}.csv`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function toggleSidebar() {
    const sidebar = document.getElementById("sidebar");
    sidebar.style.width = sidebar.style.width === "250px" ? "0" : "250px";
  }



  function setDateRange(range) {
  const fromInput = document.getElementById("fromDate");
  const toInput = document.getElementById("toDate");

  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, '0');
  const dd = String(today.getDate()).padStart(2, '0');
  const todayStr = `${yyyy}-${mm}-${dd}`;

  let from, to;

  switch (range) {
    case 'today':
      from = to = todayStr;
      break;
    case 'last7':
      from = new Date(today);
      from.setDate(today.getDate() - 6);
      from = from.toISOString().split("T")[0];
      to = todayStr;
      break;
    case 'lastMonth':
      const firstDayLastMonth = new Date(yyyy, today.getMonth() - 1, 1);
      const lastDayLastMonth = new Date(yyyy, today.getMonth(), 0);
      from = firstDayLastMonth.toISOString().split("T")[0];
      to = lastDayLastMonth.toISOString().split("T")[0];
      break;
    case 'thisYear':
      from = `${yyyy}-01-01`;
      to = todayStr;
      break;
    case 'all':
      from = '2000-01-01';
      to = todayStr;
      break;
    default:
      return;
  }

  fromInput.value = from;
  toInput.value = to;
}



  </script>


   
</body>
</html>
